(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[923],{9694:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/homebase",function(){return s(7092)}])},5932:function(e,t,s){"use strict";s.d(t,{IO:function(){return u},JU:function(){return x},PL:function(){return n},QT:function(){return m},Xo:function(){return a},ar:function(){return l},b9:function(){return d},db:function(){return c},hJ:function(){return i}});let r={products:[{id:"hemp-flower-1",name:"Purple Kush Hemp Flower",description:"Premium quality hemp flower with a rich terpene profile and a soothing aroma. Perfect for relaxation and stress relief.",category:"Flowers",subcategory:"Premium",price:29.99,salePrice:null,strain:"indica",thcContent:.2,cbdContent:18.5,inStock:!0,stockCount:50,images:["/images/products/hemp-flower-1.jpg","/images/products/hemp-flower-1-detail.jpg"],barcode:"HF10012345",coaUrl:"/coa/hemp-flower-1.pdf",tags:["premium","hemp flower","indica","relaxation"],featured:!0,createdAt:Date.now()-2592e6,updatedAt:Date.now()-432e6},{id:"cbd-oil-1",name:"Full Spectrum CBD Oil 1000mg",description:"Our premium CBD oil contains a full spectrum of cannabinoids for maximum effectiveness.",category:"CBD Oils",subcategory:"Full Spectrum",price:69.99,salePrice:59.99,strain:null,thcContent:.1,cbdContent:1e3,inStock:!0,stockCount:35,images:["/images/products/cbd-oil-1.jpg","/images/products/cbd-oil-1-detail.jpg"],barcode:"CB10056789",coaUrl:"/coa/cbd-oil-1.pdf",tags:["premium","cbd oil","full spectrum","tincture"],featured:!0,createdAt:Date.now()-1296e6,updatedAt:Date.now()-1728e5},{id:"gummies-1",name:"CBD Gummies 25mg",description:"Delicious fruit-flavored gummies with 25mg of CBD per piece.",category:"Edibles",subcategory:"Gummies",price:24.99,salePrice:null,strain:null,thcContent:0,cbdContent:25,inStock:!0,stockCount:100,images:["/images/products/gummies-1.jpg"],barcode:"ED10034567",coaUrl:"/coa/gummies-1.pdf",tags:["edibles","gummies","cbd","fruit flavor"],featured:!1,createdAt:Date.now()-3888e6,updatedAt:Date.now()-864e6}],users:[],orders:[]},i=(e,t)=>(console.log("collection() called with: collectionName=".concat(t)),{id:t,path:t,type:"collection"}),n=async e=>{console.log("getDocs called with query:",e);let t="products";e&&e.path&&(t=e.path,console.log("Using path from querySnapshot: ".concat(t)));let s=[...r[t]||[]];if(console.log("Found ".concat(s.length," products in mock data")),s.length>0&&console.log("Sample product timestamp:",s[0].createdAt,"type:",typeof s[0].createdAt),e&&e._queryConstraints&&e._queryConstraints.length>0){console.log("Applying query constraints...");let t=e._queryConstraints.filter(e=>"orderBy"===e.type);if(t.length>0){console.log("Found orderBy constraints:",t);let{field:e,direction:r}=t[0];console.log("Sorting by ".concat(e," ").concat(r)),s.sort((t,s)=>{let i=t[e],n=s[e];return(void 0===i&&(i=0),void 0===n&&(n=0),"string"!=typeof i||isNaN(Date.parse(i))||(i=Date.parse(i)),"string"!=typeof n||isNaN(Date.parse(n))||(n=Date.parse(n)),"desc"===r)?n-i:i-n}),s.length>0&&console.log("First sorted product:",s[0].name,"createdAt:",s[0].createdAt)}}console.log("Returning ".concat(s.length," products after processing query"));let i=s.map(e=>({id:e.id,data:()=>e,exists:()=>!0}));return{docs:i,forEach:e=>{i.forEach(e)},empty:0===s.length,size:s.length}},l=(e,t,s)=>({type:"where",field:e,operator:t,value:s}),d=e=>({type:"limit",value:e}),a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";return{type:"orderBy",field:e,direction:t}};class o{toJSON(){return"MockFirestore"}collection(e){return console.log("MockFirestore.collection called with: ".concat(e)),{id:e,path:e,type:"collection"}}doc(e,t){return console.log("MockFirestore.doc called with: ".concat(e,", ").concat(t)),{id:t,path:"".concat(e,"/").concat(t),type:"document",async get(){let s=(r[e]||[]).find(e=>e.id===t);return{exists:()=>!!s,data:()=>s||null,id:t}}}}constructor(){this.type="firestore",console.log("MockFirestore initialized with these collections:",Object.keys(r))}}console.log("Creating mock Firestore database...");let c=new o;console.log("Mock Firestore database created and exported.");let m=async e=>{let t=await e.get();return{exists:()=>t.exists(),data:()=>t.data(),id:e.id}},x=(e,t,s)=>(console.log("doc() called with: collectionPath=".concat(t,", docId=").concat(s)),e&&"function"==typeof e.doc)?(console.log("Using db.doc() method directly"),e.doc(t,s)):(console.log("Using generic mock doc implementation"),{id:s,path:"".concat(t,"/").concat(s),type:"document",async get(){let e=(r[t]||[]).find(e=>e.id===s);return{exists:()=>!!e,data:()=>e||null,id:s}}}),u=function(e){for(var t=arguments.length,s=Array(t>1?t-1:0),r=1;r<t;r++)s[r-1]=arguments[r];return console.log("Creating query with constraints:",s),{...e,_queryConstraints:s}}},7092:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return m}});var r=s(5893),i=s(7294),n=s(1163),l=s(1664),d=s.n(l),a=s(9828),o=s(5932),c=s(6197);function m(){let{userData:e}=(0,c.a)(),t=(0,n.useRouter)(),[s,l]=(0,i.useState)([]),[m,x]=(0,i.useState)({}),[u,h]=(0,i.useState)(!0),[p,g]=(0,i.useState)(null),[f,b]=(0,i.useState)(!1);(0,i.useEffect)(()=>{if(e&&"homebase"!==e.role){t.push("/");return}let s=(0,a.cf)((0,a.IO)((0,a.hJ)(o.db,"orders"),(0,a.ar)("status","in",["received","processing","ready"]),(0,a.Xo)("createdAt","asc")),e=>{let t=[];e.forEach(e=>{t.push({id:e.id,...e.data()})}),l(t),h(!1)},e=>{console.error("Error fetching orders:",e),h(!1)}),r=(0,a.cf)((0,a.hJ)(o.db,"products"),e=>{let t={};e.forEach(e=>{t[e.id]={id:e.id,...e.data()}}),x(t)},e=>{console.error("Error fetching products:",e)});return()=>{s(),r()}},[e,t]);let y=async(e,t)=>{try{g(e);let s=(0,a.JU)(o.db,"orders",e),r=Date.now(),i={status:t};"processing"===t?i.orderProcessing=r:"ready"===t&&(i.orderReady=r),await (0,a.r7)(s,i)}catch(e){console.error("Error updating order status:",e)}finally{g(null)}},v=async()=>{try{b(!0),await new Promise(e=>setTimeout(e,2e3))}catch(e){console.error("Error refreshing inventory:",e)}finally{b(!1)}},j=e=>e.items.every(e=>{let t=m[e.productId];return t&&t.inStock&&t.stockCount>=e.quantity}),w=s.filter(e=>"received"===e.status),N=s.filter(e=>"processing"===e.status),k=s.filter(e=>"ready"===e.status);return(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-4 md:mb-0",children:"Home Base Dashboard"}),(0,r.jsx)("button",{onClick:v,disabled:f,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:f?(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-4 h-4 border-t-2 border-b-2 border-white rounded-full animate-spin mr-2"}),"Syncing..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Sync Inventory"]})})]}),u?(0,r.jsx)("div",{className:"flex justify-center py-20",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-green-500"})}):(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[(0,r.jsx)("div",{className:"bg-blue-500 px-4 py-3",children:(0,r.jsxs)("h2",{className:"text-lg font-medium text-white",children:["New Orders (",w.length,")"]})}),(0,r.jsx)("div",{className:"divide-y divide-gray-200",children:w.length>0?w.map(e=>{let t=j(e);return(0,r.jsx)("div",{className:"p-4",children:(0,r.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:["Order #",e.id.slice(0,8)]}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:new Date(e.createdAt).toLocaleString()}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:[e.items.length," items \xb7 $",e.total.toFixed(2)]}),(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("pickup"===e.fulfillmentMethod?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"),children:"pickup"===e.fulfillmentMethod?"Pickup":"Delivery"}),!t&&(0,r.jsx)("span",{className:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"Stock Issue"})]})]}),(0,r.jsxs)("div",{className:"mt-4 md:mt-0 flex flex-col space-y-2",children:[(0,r.jsx)(d(),{href:"/homebase/orders/".concat(e.id),className:"inline-flex items-center px-3 py-1 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"View Details"}),(0,r.jsx)("button",{onClick:()=>y(e.id,"processing"),disabled:p===e.id||!t,className:"inline-flex items-center px-3 py-1 border border-transparent text-sm font-medium rounded-md text-white ".concat(t?"bg-green-600 hover:bg-green-700":"bg-gray-400 cursor-not-allowed"),children:p===e.id?(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-4 h-4 border-t-2 border-b-2 border-white rounded-full animate-spin mr-1"}),"Processing..."]}):"Start Processing"})]})]})},e.id)}):(0,r.jsx)("div",{className:"p-6 text-center",children:(0,r.jsx)("p",{className:"text-gray-500",children:"No new orders"})})})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[(0,r.jsx)("div",{className:"bg-yellow-500 px-4 py-3",children:(0,r.jsxs)("h2",{className:"text-lg font-medium text-white",children:["Processing (",N.length,")"]})}),(0,r.jsx)("div",{className:"divide-y divide-gray-200",children:N.length>0?N.map(e=>(0,r.jsx)("div",{className:"p-4",children:(0,r.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:["Order #",e.id.slice(0,8)]}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:new Date(e.createdAt).toLocaleString()}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:[e.items.length," items \xb7 $",e.total.toFixed(2)]}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("pickup"===e.fulfillmentMethod?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"),children:"pickup"===e.fulfillmentMethod?"Pickup":"Delivery"})})]}),(0,r.jsxs)("div",{className:"mt-4 md:mt-0 flex flex-col space-y-2",children:[(0,r.jsx)(d(),{href:"/homebase/orders/".concat(e.id),className:"inline-flex items-center px-3 py-1 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"View Details"}),(0,r.jsx)("button",{onClick:()=>y(e.id,"ready"),disabled:p===e.id,className:"inline-flex items-center px-3 py-1 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700",children:p===e.id?(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-4 h-4 border-t-2 border-b-2 border-white rounded-full animate-spin mr-1"}),"Updating..."]}):"Mark Ready"})]})]})},e.id)):(0,r.jsx)("div",{className:"p-6 text-center",children:(0,r.jsx)("p",{className:"text-gray-500",children:"No orders in processing"})})})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[(0,r.jsx)("div",{className:"bg-green-500 px-4 py-3",children:(0,r.jsxs)("h2",{className:"text-lg font-medium text-white",children:["Ready for Pickup/Delivery (",k.length,")"]})}),(0,r.jsx)("div",{className:"divide-y divide-gray-200",children:k.length>0?k.map(e=>(0,r.jsx)("div",{className:"p-4",children:(0,r.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:["Order #",e.id.slice(0,8)]}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:new Date(e.createdAt).toLocaleString()}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:[e.items.length," items \xb7 $",e.total.toFixed(2)]}),(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("pickup"===e.fulfillmentMethod?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"),children:"pickup"===e.fulfillmentMethod?"Pickup":"Delivery"}),e.driverId&&(0,r.jsx)("span",{className:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Driver Assigned"})]})]}),(0,r.jsxs)("div",{className:"mt-4 md:mt-0 flex flex-col space-y-2",children:[(0,r.jsx)(d(),{href:"/homebase/orders/".concat(e.id),className:"inline-flex items-center px-3 py-1 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"View Details"}),"pickup"===e.fulfillmentMethod&&(0,r.jsx)("button",{onClick:()=>y(e.id,"completed"),disabled:p===e.id,className:"inline-flex items-center px-3 py-1 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700",children:p===e.id?(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-4 h-4 border-t-2 border-b-2 border-white rounded-full animate-spin mr-1"}),"Updating..."]}):"Complete Pickup"}),"delivery"===e.fulfillmentMethod&&!e.driverId&&(0,r.jsx)(d(),{href:"/homebase/assign-driver/".concat(e.id),className:"inline-flex items-center px-3 py-1 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:"Assign Driver"})]})]})},e.id)):(0,r.jsx)("div",{className:"p-6 text-center",children:(0,r.jsx)("p",{className:"text-gray-500",children:"No orders ready for pickup/delivery"})})})]})]}),(0,r.jsxs)("div",{className:"mt-8 bg-white rounded-lg shadow-md overflow-hidden",children:[(0,r.jsx)("div",{className:"px-4 py-5 sm:px-6",children:(0,r.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Today's Summary"})}),(0,r.jsx)("div",{className:"border-t border-gray-200 px-4 py-5 sm:p-6",children:(0,r.jsxs)("dl",{className:"grid grid-cols-1 gap-x-4 gap-y-8 sm:grid-cols-2 md:grid-cols-4",children:[(0,r.jsxs)("div",{className:"sm:col-span-1",children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Total Orders"}),(0,r.jsx)("dd",{className:"mt-1 text-3xl font-semibold text-gray-900",children:s.length})]}),(0,r.jsxs)("div",{className:"sm:col-span-1",children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Pickups"}),(0,r.jsx)("dd",{className:"mt-1 text-3xl font-semibold text-gray-900",children:s.filter(e=>"pickup"===e.fulfillmentMethod).length})]}),(0,r.jsxs)("div",{className:"sm:col-span-1",children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Deliveries"}),(0,r.jsx)("dd",{className:"mt-1 text-3xl font-semibold text-gray-900",children:s.filter(e=>"delivery"===e.fulfillmentMethod).length})]}),(0,r.jsxs)("div",{className:"sm:col-span-1",children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Revenue"}),(0,r.jsxs)("dd",{className:"mt-1 text-3xl font-semibold text-green-600",children:["$",s.reduce((e,t)=>e+t.total,0).toFixed(2)]})]})]})})]}),(0,r.jsxs)("div",{className:"mt-8 grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[(0,r.jsx)("div",{className:"bg-white overflow-hidden shadow-md rounded-lg",children:(0,r.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})}),(0,r.jsx)("h3",{className:"ml-3 text-lg font-medium text-gray-900",children:"All Orders"})]}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(d(),{href:"/homebase/orders",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200",children:"View All Orders"})})]})}),(0,r.jsx)("div",{className:"bg-white overflow-hidden shadow-md rounded-lg",children:(0,r.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),(0,r.jsx)("h3",{className:"ml-3 text-lg font-medium text-gray-900",children:"Inventory"})]}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(d(),{href:"/homebase/inventory",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-green-700 bg-green-100 hover:bg-green-200",children:"Manage Inventory"})})]})}),(0,r.jsx)("div",{className:"bg-white overflow-hidden shadow-md rounded-lg",children:(0,r.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-purple-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),(0,r.jsx)("h3",{className:"ml-3 text-lg font-medium text-gray-900",children:"Drivers"})]}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(d(),{href:"/homebase/drivers",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-purple-700 bg-purple-100 hover:bg-purple-200",children:"Manage Drivers"})})]})})]})]})}}},function(e){e.O(0,[16,827,888,774,179],function(){return e(e.s=9694)}),_N_E=e.O()}]);